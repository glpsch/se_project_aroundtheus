!function(){"use strict";const e={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},t="place-card__like-icon_liked",s="popup_is-opened",r={baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"5c01f697-815f-4c7b-b7c4-42ef59bfe205","Content-Type":"application/json"}};class i{constructor(e,t){this._settings=e,this._formElement=t,this._inputs=this._formElement.querySelectorAll(this._settings.inputSelector),this._submitButton=this._formElement.querySelector(this._settings.submitButtonSelector)}_checkInputValidity(e){const t=this._formElement.querySelector(`#${e.id}-error`);t&&(e.validity.valid?this._hideInputError(e,t):this._showInputError(e,t))}_showInputError(e,t){e.classList.add(this._settings.inputErrorClass),t.classList.add(this._settings.errorClass),t.textContent=e.validationMessage}_hideInputError(e,t){e.classList.remove(this._settings.inputErrorClass),t.classList.remove(this._settings.errorClass),t.textContent=""}_isFormValid(){return Array.from(this._inputs).every(e=>e.validity.valid)}_toggleButtonState(){this._submitButton&&(this._isFormValid()?(this._submitButton.classList.remove(this._settings.inactiveButtonClass),this._submitButton.disabled=!1):(this._submitButton.classList.add(this._settings.inactiveButtonClass),this._submitButton.disabled=!0))}_validateFormState(){this._inputs.forEach(e=>{this._checkInputValidity(e)}),this._toggleButtonState()}_addEventListeners(){this._inputs.forEach(e=>{e.addEventListener("input",()=>this._validateFormState())}),this._formElement.addEventListener("submit",e=>(e.preventDefault(),this._isFormValid()))}enableValidation(){this._addEventListeners(),this._validateFormState()}_isFormEmpty(){return Array.from(this._inputs).every(e=>""===e.value)}resetValidationIfEmpty(){this._isFormEmpty()&&this.resetValidation()}resetValidation(){this._inputs.forEach(e=>{const t=this._formElement.querySelector(`#${e.id}-error`);t&&this._hideInputError(e,t)}),this._toggleButtonState()}}class n{constructor(e,t,s,r,i){this.name=e.name,this.link=e.link,this._id=e._id??e.id,this._template=t,this._handleImageClick=s,this._handleDelete=r,this._api=i,this.isLiked=Boolean(e.isLiked),this._element=null}_getTemplate(){return this._template.content.querySelector(".place-card").cloneNode(!0)}_generateCard(){return this._element=this._getTemplate(),this._cardImageElement=this._element.querySelector(".place-card__image"),this._cardNameElement=this._element.querySelector(".place-card__name"),this._likeButton=this._element.querySelector(".place-card__like-icon"),this._deleteButton=this._element.querySelector(".place-card__delete-icon"),this._cardImageElement.style.backgroundImage=`url(${this.link})`,this._cardNameElement.textContent=this.name,this.isLiked&&this._likeButton.classList.add(t),this._setEventListeners(),this._element}getElement(){return this._element||this._generateCard(),this._element}_handleLike(){const e=!this.isLiked;this._api.changeLikeStatus(this._id,e).then(()=>{this.isLiked=e,this._likeButton.classList.toggle(t)}).catch(()=>{})}deleteCard(e){return e.deleteCard(this._id).then(()=>this.getElement().remove())}_onDeleteClick(){this._handleDelete?this._handleDelete(this):this._element.remove()}_setEventListeners(){this._cardImageElement.addEventListener("click",()=>{this._handleImageClick(this)}),this._likeButton.addEventListener("click",e=>{e.stopPropagation(),this._handleLike()}),this._deleteButton.addEventListener("click",e=>{e.stopPropagation(),this._onDeleteClick()})}}class a{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=s}renderItems(){this._items.forEach(e=>{this._renderer(e)})}addItem(e){this._container.appendChild(e)}prependItem(e){this._container.prepend(e)}}class o{constructor(e){this._popup=document.querySelector(e),this._closeButton=this._popup.querySelector(".popup__close")}open(){this._popup.classList.add(s),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove(s),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popup.addEventListener("click",e=>{e.target!==this._popup&&e.target!==this._closeButton||this.close()})}}class l extends o{constructor(e){super(e),this._imageElement=this._popup.querySelector(".popup__image img"),this._imageDescription=this._popup.querySelector(".popup__image-description")}open(e,t){if(this._imageElement)this._imageElement.src=t,this._imageElement.alt=e;else{const e=this._popup.querySelector(".popup__image");e&&(e.style.backgroundImage=`url(${t})`)}this._imageDescription.textContent=e,super.open()}}class _ extends o{constructor(e,t){super(e),this._handleFormSubmit=t,this._form=this._popup.querySelector(".popup__form"),this._inputs=this._form.querySelectorAll(".popup__input"),this._formData={},this._submit=this._popup.querySelector(".popup__button")}_getInputValues(){const e={};return this._inputs.forEach(t=>{e[t.name]=t.value}),e}setInputValues(e){this._inputs.forEach(t=>{t.value=e[t.name]})}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues(),this)})}open(){Object.keys(this._formData).length>0&&this.setInputValues(this._formData),super.open()}close(){this._formData=this._getInputValues(),super.close(),this._form._formValidator&&this._form._formValidator.resetValidation()}resetForm(){this._form.reset(),this._formData={},this._form._formValidator&&this._form._formValidator.resetValidation()}renderLoading(e){this._submit.textContent=e?"Saving...":"Save"}}class u{constructor({nameSelector:e,jobSelector:t,avatarSelector:s}){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this._avatarElement=s?document.querySelector(s):null}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo({name:e,job:t,avatar:s}){this._nameElement.textContent=e,this._jobElement.textContent=t,this._avatarElement&&(this._avatarElement.style.backgroundImage=`url(${s})`)}}class c{constructor({baseUrl:e,headers:t,onError:s}){this._baseUrl=e,this._headers=t,this._onError=s??(e=>console.error(e))}_handleResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t={}){return fetch(`${this._baseUrl}${e}`,{headers:{...this._headers,...t.headers||{}},...t}).then(this._handleResponse).catch(e=>(this._onError(e),Promise.reject(e)))}getUserInfo(){return this._request("/users/me")}updateUserInfo({name:e,about:t}){return this._request("/users/me",{method:"PATCH",body:JSON.stringify({name:e,about:t})})}updateAvatar({avatar:e}){return this._request("/users/me/avatar",{method:"PATCH",body:JSON.stringify({avatar:e})})}getInitialCards(){return this._request("/cards")}createCard({name:e,link:t}){return this._request("/cards",{method:"POST",body:JSON.stringify({name:e,link:t})})}deleteCard(e){return this._request(`/cards/${e}`,{method:"DELETE"})}changeLikeStatus(e,t){return this._request(`/cards/${e}/likes`,{method:t?"PUT":"DELETE"})}}const h=document.querySelector("#place-card-template"),d=document.querySelector(".popup_edit-user .popup__form"),p=document.querySelector(".popup_add-card .popup__form"),m=document.querySelector(".popup_edit-avatar .popup__form"),E=document.querySelector(".user-info__edit-icon"),f=document.querySelector(".user-info__place-button"),g=document.querySelector(".user-info__edit-avatar"),v=document.querySelector(".places-list");!function(){const t=new l(".popup_image"),s=new c(r),o=e=>{t.open(e.name,e.link)};let y=null;const b=e=>{y=e,V.open()};function S(e){return new n(e,h,o,b,s).getElement()}const L=new a({items:[],renderer:e=>{const t=S(e);L.addItem(t)}},v),k=new u({nameSelector:".user-info__name",jobSelector:".user-info__job",avatarSelector:".user-info__photo"});Promise.all([s.getUserInfo(),s.getInitialCards()]).then(([e,t])=>{k.setUserInfo({name:e.name,job:e.about,avatar:e.avatar}),t.forEach(e=>{const t=S(e);L.addItem(t)})}).catch(()=>{});const I=new _(".popup_edit-user",(e,t)=>{t.renderLoading(!0),s.updateUserInfo({name:e.name,about:e.info}).then(e=>{k.setUserInfo({name:e.name,job:e.about,avatar:e.avatar}),t.close()}).catch(()=>{}).finally(()=>{t.renderLoading(!1)})}),C=new _(".popup_add-card",(e,t)=>{const r={name:e.title,link:e.link};t.renderLoading(!0),s.createCard(r).then(e=>{!function(e){const t=S(e);L.prependItem(t)}(e),t.resetForm(),t.close()}).catch(()=>{}).finally(()=>{t.renderLoading(!1)})}),q=new _(".popup_edit-avatar",(e,t)=>{t.renderLoading(!0),s.updateAvatar({avatar:e.link}).then(e=>{k.setUserInfo({name:e.name,job:e.about,avatar:e.avatar}),t.resetForm(),t.close()}).catch(()=>{}).finally(()=>{t.renderLoading(!1)})}),V=new _(".popup_confirm-delete",(e,t)=>{y?y.deleteCard(s).then(()=>{t.close(),y=null}).catch(()=>{}):t.close()}),B=new i(e,d),j=new i(e,p),w=new i(e,m);d._formValidator=B,p._formValidator=j,m._formValidator=w,B.enableValidation(),j.enableValidation(),w.enableValidation(),t.setEventListeners(),I.setEventListeners(),C.setEventListeners(),q.setEventListeners(),V.setEventListeners(),f.addEventListener("click",()=>{C.open(),j.resetValidationIfEmpty()}),E.addEventListener("click",()=>{const e=k.getUserInfo();I.setInputValues({name:e.name,info:e.job}),I.open(),B.resetValidation()}),g.addEventListener("click",()=>{q.open(),w.resetValidationIfEmpty()})}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU1jLEVBQWdCdEUsTUFFeEJxRCxFQUFrQjVGLE9BQ2xCMEcsRUFBa0JwSyxvQkFHcEJ3SSxFQUFxQi9JLGlCQUFpQixRQUFTLEtBQzdDd0ssRUFBb0J2RyxPQUNwQjRHLEVBQW9CdkssMEJBSXZCLENBNU1ELEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9JbnNlcnQgcHJvamVjdCBuYW1lLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9JbnNlcnQgcHJvamVjdCBuYW1lLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9JbnNlcnQgcHJvamVjdCBuYW1lLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9JbnNlcnQgcHJvamVjdCBuYW1lLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9JbnNlcnQgcHJvamVjdCBuYW1lLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vSW5zZXJ0IHByb2plY3QgbmFtZS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL0luc2VydCBwcm9qZWN0IG5hbWUvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL0luc2VydCBwcm9qZWN0IG5hbWUvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9JbnNlcnQgcHJvamVjdCBuYW1lLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL0luc2VydCBwcm9qZWN0IG5hbWUvLi9zcmMvcGFnZXMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IHNlbGVjdG9ycyA9IHtcbiAgLy8gVGVtcGxhdGVzXG4gIGNhcmRUZW1wbGF0ZTogXCIjcGxhY2UtY2FyZC10ZW1wbGF0ZVwiLFxuXG4gIC8vIEZvcm1zXG4gIGVkaXRGb3JtOiBcIi5wb3B1cF9lZGl0LXVzZXIgLnBvcHVwX19mb3JtXCIsXG4gIGFkZENhcmRGb3JtOiBcIi5wb3B1cF9hZGQtY2FyZCAucG9wdXBfX2Zvcm1cIixcbiAgYXZhdGFyRm9ybTogXCIucG9wdXBfZWRpdC1hdmF0YXIgLnBvcHVwX19mb3JtXCIsXG5cbiAgLy8gUG9wdXBzXG4gIHBvcHVwSW1hZ2U6IFwiLnBvcHVwX2ltYWdlXCIsXG4gIHBvcHVwRWRpdFVzZXI6IFwiLnBvcHVwX2VkaXQtdXNlclwiLFxuICBwb3B1cEFkZENhcmQ6IFwiLnBvcHVwX2FkZC1jYXJkXCIsXG4gIHBvcHVwQ29uZmlybURlbGV0ZTogXCIucG9wdXBfY29uZmlybS1kZWxldGVcIixcbiAgcG9wdXBFZGl0QXZhdGFyOiBcIi5wb3B1cF9lZGl0LWF2YXRhclwiLFxuXG4gIC8vIFVzZXIgSW5mb1xuICB1c2VyTmFtZTogXCIudXNlci1pbmZvX19uYW1lXCIsXG4gIHVzZXJKb2I6IFwiLnVzZXItaW5mb19fam9iXCIsXG4gIHVzZXJBdmF0YXI6IFwiLnVzZXItaW5mb19fcGhvdG9cIixcbiAgdXNlckVkaXRCdXR0b246IFwiLnVzZXItaW5mb19fZWRpdC1pY29uXCIsXG4gIHVzZXJBZGRQbGFjZUJ1dHRvbjogXCIudXNlci1pbmZvX19wbGFjZS1idXR0b25cIixcbiAgdXNlckVkaXRBdmF0YXJCdXR0b246IFwiLnVzZXItaW5mb19fZWRpdC1hdmF0YXJcIixcblxuICAvLyBMaXN0c1xuICBwbGFjZXNMaXN0OiBcIi5wbGFjZXMtbGlzdFwiLFxuXG4gIC8vIElucHV0IGZpZWxkc1xuICBuYW1lSW5wdXQ6IFwiI25hbWVcIixcbiAgaW5mb0lucHV0OiBcIiNpbmZvXCIsXG59O1xuXG4vLyBWYWxpZGF0aW9uIGNvbmZpZ3VyYXRpb25cbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcbn07XG5cbi8vIENhcmQtcmVsYXRlZCBjb25zdGFudHNcbmV4cG9ydCBjb25zdCBjYXJkQ29uZmlnID0ge1xuICBjYXJkOiBcIi5wbGFjZS1jYXJkXCIsXG4gIGNhcmRJbWFnZTogXCIucGxhY2UtY2FyZF9faW1hZ2VcIixcbiAgY2FyZE5hbWU6IFwiLnBsYWNlLWNhcmRfX25hbWVcIixcbiAgbGlrZUJ1dHRvbjogXCIucGxhY2UtY2FyZF9fbGlrZS1pY29uXCIsXG4gIGRlbGV0ZUJ1dHRvbjogXCIucGxhY2UtY2FyZF9fZGVsZXRlLWljb25cIixcbiAgbGlrZWRDbGFzczogXCJwbGFjZS1jYXJkX19saWtlLWljb25fbGlrZWRcIixcbn07XG5cbi8vIFBvcHVwLXJlbGF0ZWQgY29uc3RhbnRzXG5leHBvcnQgY29uc3QgcG9wdXBDb25maWcgPSB7XG4gIGNsb3NlQnV0dG9uOiBcIi5wb3B1cF9fY2xvc2VcIixcbiAgZm9ybTogXCIucG9wdXBfX2Zvcm1cIixcbiAgaW5wdXQ6IFwiLnBvcHVwX19pbnB1dFwiLFxuICBzdWJtaXQ6IFwiLnBvcHVwX19idXR0b25cIixcblxuICBpbWFnZTogXCIucG9wdXBfX2ltYWdlXCIsXG4gIGltYWdlSW1nOiBcIi5wb3B1cF9faW1hZ2UgaW1nXCIsXG4gIGltYWdlRGVzY3JpcHRpb246IFwiLnBvcHVwX19pbWFnZS1kZXNjcmlwdGlvblwiLFxuXG4gIG9wZW5lZENsYXNzOiBcInBvcHVwX2lzLW9wZW5lZFwiLFxufVxuXG4gIC8vIEFQSVxuXG4gIGV4cG9ydCBjb25zdCBhcGlDb25maWcgPSB7XG4gICAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgIGF1dGhvcml6YXRpb246IFwiNWMwMWY2OTctODE1Zi00YzdiLWI3YzQtNDJlZjU5YmZlMjA1XCIsXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgIH1cbiAgfTtcbiIsIlwidXNlIHN0cmljdFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5fc2V0dGluZ3MgPSBzZXR0aW5ncztcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuX2lucHV0cyA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXG4gICAgICB0aGlzLl9zZXR0aW5ncy5pbnB1dFNlbGVjdG9yXG4gICAgKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICB9XG5cbiAgLy8gUHJpdmF0ZSBtZXRob2QgdG8gY2hlY2sgZmllbGQgdmFsaWRpdHlcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0LmlkfS1lcnJvcmApO1xuICAgIGlmICghZXJyb3JFbGVtZW50KSByZXR1cm47XG5cbiAgICBpZiAoaW5wdXQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0LCBlcnJvckVsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dCwgZXJyb3JFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICAvLyBQcml2YXRlIG1ldGhvZCB0byBzaG93IGVycm9yIGZvciBhbiBpbnB1dFxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXQsIGVycm9yRWxlbWVudCkge1xuICAgIGlucHV0LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgfVxuXG4gIC8vIFByaXZhdGUgbWV0aG9kIHRvIGhpZGUgZXJyb3IgZm9yIGFuIGlucHV0XG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dCwgZXJyb3JFbGVtZW50KSB7XG4gICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH1cblxuICAvLyBQcml2YXRlIG1ldGhvZCB0byBjaGVjayBpZiBlbnRpcmUgZm9ybSBpcyB2YWxpZFxuICBfaXNGb3JtVmFsaWQoKSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5faW5wdXRzKS5ldmVyeSgoaW5wdXQpID0+IGlucHV0LnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIC8vIFByaXZhdGUgbWV0aG9kIHRvIHRvZ2dsZSBidXR0b24gc3RhdGUgYmFzZWQgb24gZm9ybSB2YWxpZGl0eVxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKCF0aGlzLl9zdWJtaXRCdXR0b24pIHJldHVybjtcblxuICAgIGlmICh0aGlzLl9pc0Zvcm1WYWxpZCgpKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgLy8gUHJpdmF0ZSBtZXRob2QgdG8gdmFsaWRhdGUgZm9ybSBzdGF0ZVxuICBfdmFsaWRhdGVGb3JtU3RhdGUoKSB7XG4gICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXQpO1xuICAgIH0pO1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gIH1cblxuICAvLyBQcml2YXRlIG1ldGhvZCB0byBhZGQgZXZlbnQgbGlzdGVuZXJzXG4gIF9hZGRFdmVudExpc3RlbmVycygpIHtcbiAgICAvLyBBZGQgaW5wdXQgZXZlbnQgbGlzdGVuZXJzXG4gICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4gdGhpcy5fdmFsaWRhdGVGb3JtU3RhdGUoKSk7XG4gICAgfSk7XG5cbiAgICAvLyBBZGQgZm9ybSBzdWJtaXQgbGlzdGVuZXJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgcmV0dXJuIHRoaXMuX2lzRm9ybVZhbGlkKCk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBQdWJsaWMgbWV0aG9kIHRvIGVuYWJsZSBmb3JtIHZhbGlkYXRpb25cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9hZGRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3ZhbGlkYXRlRm9ybVN0YXRlKCk7XG4gIH1cblxuICAvLyBQcml2YXRlIG1ldGhvZCB0byBjaGVjayBpZiBhbGwgZm9ybSBpbnB1dHMgYXJlIGVtcHR5XG4gIF9pc0Zvcm1FbXB0eSgpIHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLl9pbnB1dHMpLmV2ZXJ5KChpbnB1dCkgPT4gaW5wdXQudmFsdWUgPT09IFwiXCIpO1xuICB9XG5cbiAgLy8gUHVibGljIG1ldGhvZCB0byByZXNldCB2YWxpZGF0aW9uIG9ubHkgaWYgZm9ybSBpcyBlbXB0eVxuICByZXNldFZhbGlkYXRpb25JZkVtcHR5KCkge1xuICAgIGlmICh0aGlzLl9pc0Zvcm1FbXB0eSgpKSB7XG4gICAgICB0aGlzLnJlc2V0VmFsaWRhdGlvbigpO1xuICAgIH1cbiAgfVxuXG4gIC8vIFB1YmxpYyBtZXRob2QgdG8gZGlzYWJsZSBidXR0b24gc3RhdGUgb3IgcmVzZXQgZm9ybSB2YWxpZGF0aW9uXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICAvLyBDbGVhciBhbGwgZXJyb3JzXG4gICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICBgIyR7aW5wdXQuaWR9LWVycm9yYFxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvckVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQsIGVycm9yRWxlbWVudCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBSZXNldCBidXR0b24gc3RhdGVcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICB9XG59XG4iLCJcInVzZSBzdHJpY3RcIjtcbmltcG9ydCB7IGNhcmRDb25maWcgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihkYXRhLCBjYXJkU2VsZWN0b3IsIGhhbmRsZUltYWdlQ2xpY2ssIGhhbmRsZURlbGV0ZSwgYXBpKSB7XG4gICAgdGhpcy5uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMubGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkID8/IGRhdGEuaWQ7XG4gICAgdGhpcy5fdGVtcGxhdGUgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlID0gaGFuZGxlRGVsZXRlO1xuICAgIHRoaXMuX2FwaSA9IGFwaTtcbiAgICBcbiAgICB0aGlzLmlzTGlrZWQgPSBCb29sZWFuKGRhdGEuaXNMaWtlZCk7XG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3RlbXBsYXRlLmNvbnRlbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKGNhcmRDb25maWcuY2FyZClcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gIH1cblxuICBfZ2VuZXJhdGVDYXJkKCkge1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoY2FyZENvbmZpZy5jYXJkSW1hZ2UpO1xuICAgIHRoaXMuX2NhcmROYW1lRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihjYXJkQ29uZmlnLmNhcmROYW1lKTtcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKGNhcmRDb25maWcubGlrZUJ1dHRvbik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKGNhcmRDb25maWcuZGVsZXRlQnV0dG9uKTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybCgke3RoaXMubGlua30pYDtcbiAgICB0aGlzLl9jYXJkTmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLm5hbWU7XG4gICAgaWYgKHRoaXMuaXNMaWtlZCkge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKGNhcmRDb25maWcubGlrZWRDbGFzcyk7XG4gICAgfVxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH1cblxuICBnZXRFbGVtZW50KCkge1xuICAgIGlmICghdGhpcy5fZWxlbWVudCkge1xuICAgICAgdGhpcy5fZ2VuZXJhdGVDYXJkKCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG5cbiAgX2hhbmRsZUxpa2UoKSB7XG4gICAgY29uc3QgbGlrZVN0YXR1cyA9ICF0aGlzLmlzTGlrZWQ7XG4gICAgdGhpcy5fYXBpXG4gICAgICAuY2hhbmdlTGlrZVN0YXR1cyh0aGlzLl9pZCwgbGlrZVN0YXR1cylcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgdGhpcy5pc0xpa2VkID0gbGlrZVN0YXR1cztcbiAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKGNhcmRDb25maWcubGlrZWRDbGFzcyk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKCgpID0+IHt9KTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoYXBpKSB7XG4gICAgcmV0dXJuIGFwaVxuICAgICAgLmRlbGV0ZUNhcmQodGhpcy5faWQpXG4gICAgICAudGhlbigoKSA9PiB0aGlzLmdldEVsZW1lbnQoKS5yZW1vdmUoKSk7XG4gIH1cblxuICBfb25EZWxldGVDbGljaygpIHtcbiAgICBpZiAodGhpcy5faGFuZGxlRGVsZXRlKSB7XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGUodGhpcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XG4gICAgfVxuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcyk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2UoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB0aGlzLl9vbkRlbGV0ZUNsaWNrKCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsIlwidXNlIHN0cmljdFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICB9XG5cbiAgcHJlcGVuZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59XG4iLCJcInVzZSBzdHJpY3RcIjtcbmltcG9ydCB7IHBvcHVwQ29uZmlnIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKHBvcHVwQ29uZmlnLmNsb3NlQnV0dG9uKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChwb3B1cENvbmZpZy5vcGVuZWRDbGFzcyk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShwb3B1cENvbmZpZy5vcGVuZWRDbGFzcyk7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGUpID0+IHtcbiAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICBpZiAoZS50YXJnZXQgPT09IHRoaXMuX3BvcHVwIHx8IGUudGFyZ2V0ID09PSB0aGlzLl9jbG9zZUJ1dHRvbikge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsIlwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcbmltcG9ydCB7IHBvcHVwQ29uZmlnIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IocG9wdXBDb25maWcuaW1hZ2VJbWcpO1xuICAgIHRoaXMuX2ltYWdlRGVzY3JpcHRpb24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFxuICAgICAgcG9wdXBDb25maWcuaW1hZ2VEZXNjcmlwdGlvblxuICAgICk7XG4gIH1cblxuICBvcGVuKG5hbWUsIGxpbmspIHtcbiAgICBpZiAodGhpcy5faW1hZ2VFbGVtZW50KSB7XG4gICAgICB0aGlzLl9pbWFnZUVsZW1lbnQuc3JjID0gbGluaztcbiAgICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hbHQgPSBuYW1lO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBJZiBubyBpbWcgZWxlbWVudCwgc2V0IGFzIGJhY2tncm91bmQgaW1hZ2VcbiAgICAgIGNvbnN0IGltZ0RpdiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IocG9wdXBDb25maWcuaW1hZ2UpO1xuICAgICAgaWYgKGltZ0Rpdikge1xuICAgICAgICBpbWdEaXYuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybCgke2xpbmt9KWA7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuX2ltYWdlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbmltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuaW1wb3J0IHsgcG9wdXBDb25maWcgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3Rvcihwb3B1cENvbmZpZy5mb3JtKTtcbiAgICB0aGlzLl9pbnB1dHMgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwocG9wdXBDb25maWcuaW5wdXQpO1xuICAgIHRoaXMuX2Zvcm1EYXRhID0ge307XG4gICAgdGhpcy5fc3VibWl0ID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3Rvcihwb3B1cENvbmZpZy5zdWJtaXQpO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XG4gICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcbiAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIC8vIEluc2VydCB0aGUgdmFsdWUgYnkgdGhlIG5hbWUgb2YgdGhlIGlucHV0XG4gICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQubmFtZV07XG4gICAgfSk7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpLCB0aGlzKTtcbiAgICB9KTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgLy8gUmVzdG9yZSBmb3JtIGRhdGEgaWYgaXQgZXhpc3RzIGZyb20gcHJldmlvdXMgY2xvc2Ugd2l0aG91dCBzdWJtaXRcbiAgICBpZiAoT2JqZWN0LmtleXModGhpcy5fZm9ybURhdGEpLmxlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMuc2V0SW5wdXRWYWx1ZXModGhpcy5fZm9ybURhdGEpO1xuICAgIH1cbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICAvLyBTYXZlIGZvcm0gZGF0YSBiZWZvcmUgY2xvc2luZ1xuICAgIHRoaXMuX2Zvcm1EYXRhID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcbiAgICBzdXBlci5jbG9zZSgpO1xuXG4gICAgLy8gUmVzZXQgdmFsaWRhdGlvbiBlcnJvcnNcbiAgICBpZiAodGhpcy5fZm9ybS5fZm9ybVZhbGlkYXRvcikge1xuICAgICAgdGhpcy5fZm9ybS5fZm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbiAgICB9XG4gIH1cblxuICByZXNldEZvcm0oKSB7XG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xuICAgIHRoaXMuX2Zvcm1EYXRhID0ge307XG4gICAgaWYgKHRoaXMuX2Zvcm0uX2Zvcm1WYWxpZGF0b3IpIHtcbiAgICAgIHRoaXMuX2Zvcm0uX2Zvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gICAgfVxuICB9XG5cbiAgLy8gT24tbG9hZCBzdWJtaXQgYnV0dG9uIGJlaGF2aW9yXG5cbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9zdWJtaXQudGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuICAgICAgIFxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXQudGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcbiAgICB9XG4gIH1cbn1cbiIsIlwidXNlIHN0cmljdFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX2pvYkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50ID0gYXZhdGFyU2VsZWN0b3JcbiAgICAgID8gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3RvcilcbiAgICAgIDogbnVsbDtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIGpvYjogdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICB9O1xuICB9XG5cbiAgc2V0VXNlckluZm8oeyBuYW1lLCBqb2IsIGF2YXRhciB9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQgPSBqb2I7XG4gICAgaWYgKHRoaXMuX2F2YXRhckVsZW1lbnQpIHtcbiAgICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybCgke2F2YXRhcn0pYDtcbiAgICB9XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzLCBvbkVycm9yIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgICB0aGlzLl9vbkVycm9yID0gb25FcnJvciA/PyAoKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBfcmVxdWVzdChwYXRoLCBvcHRpb25zID0ge30pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfSR7cGF0aH1gLCB7XHJcbiAgICAgIGhlYWRlcnM6IHsgLi4udGhpcy5faGVhZGVycywgLi4uKG9wdGlvbnMuaGVhZGVycyB8fCB7fSkgfSxcclxuICAgICAgLi4ub3B0aW9ucyxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIHRoaXMuX29uRXJyb3IoZXJyKTtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG4gXHJcblxyXG4gIC8vIFVzZXJcclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi91c2Vycy9tZVwiKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZVVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXCIvdXNlcnMvbWVcIiwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBhYm91dCB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlQXZhdGFyKHsgYXZhdGFyIH0pIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KFwiL3VzZXJzL21lL2F2YXRhclwiLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhciB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gQ2FyZHMgXHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KFwiL2NhcmRzXCIpO1xyXG4gIH1cclxuXHJcblxyXG5cclxuICBjcmVhdGVDYXJkKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi9jYXJkc1wiLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgbGluayB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAvY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNoYW5nZUxpa2VTdGF0dXMoY2FyZElkLCBzaG91bGRMaWtlKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgL2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBzaG91bGRMaWtlID8gXCJQVVRcIiA6IFwiREVMRVRFXCIsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG5cclxufVxyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxuXHJcbmltcG9ydCB7IHZhbGlkYXRpb25Db25maWcsIHNlbGVjdG9ycywgYXBpQ29uZmlnIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuXHJcbi8vIERPTSBFbGVtZW50c1xyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy5jYXJkVGVtcGxhdGUpO1xyXG5jb25zdCBlZGl0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JzLmVkaXRGb3JtKTtcclxuY29uc3QgYWRkQ2FyZEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy5hZGRDYXJkRm9ybSk7XHJcbmNvbnN0IGF2YXRhckZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy5hdmF0YXJGb3JtKTtcclxuY29uc3QgdXNlckVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy51c2VyRWRpdEJ1dHRvbik7XHJcbmNvbnN0IHVzZXJBZGRQbGFjZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JzLnVzZXJBZGRQbGFjZUJ1dHRvbik7XHJcbmNvbnN0IHVzZXJFZGl0QXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBzZWxlY3RvcnMudXNlckVkaXRBdmF0YXJCdXR0b25cclxuKTtcclxuY29uc3QgcGxhY2VzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JzLnBsYWNlc0xpc3QpO1xyXG5cclxuLy8gSW5pdGlhbGl6ZSBldmVyeXRoaW5nXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uoc2VsZWN0b3JzLnBvcHVwSW1hZ2UpO1xyXG5cclxuICBjb25zdCBhcGkgPSBuZXcgQXBpKGFwaUNvbmZpZyk7XHJcblxyXG4gIGNvbnN0IGhhbmRsZUltYWdlQ2xpY2sgPSAoY2FyZCkgPT4ge1xyXG4gICAgcG9wdXBXaXRoSW1hZ2Uub3BlbihjYXJkLm5hbWUsIGNhcmQubGluayk7XHJcbiAgfTtcclxuICBcclxuICAvLyBSZW1lbWJlciB3aGljaCBjYXJkIHRvIGRlbGV0ZVxyXG5cclxuICBsZXQgY2FyZFRvRGVsZXRlID0gbnVsbDtcclxuXHJcbiAgY29uc3QgaGFuZGxlRGVsZXRlUmVxdWVzdCA9IChjYXJkKSA9PiB7XHJcbiAgICBjYXJkVG9EZWxldGUgPSBjYXJkO1xyXG4gICAgcG9wdXBXaXRoQ29uZmlybURlbGV0ZS5vcGVuKCk7XHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSkge1xyXG4gICAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgICBjYXJkRGF0YSxcclxuICAgICAgY2FyZFRlbXBsYXRlLFxyXG4gICAgICBoYW5kbGVJbWFnZUNsaWNrLFxyXG4gICAgICBoYW5kbGVEZWxldGVSZXF1ZXN0LFxyXG4gICAgICBhcGlcclxuICAgICk7XHJcbiAgICByZXR1cm4gY2FyZC5nZXRFbGVtZW50KCk7XHJcbiAgfVxyXG5cclxuICAvLyBDcmVhdGUgU2VjdGlvbiB3aXRoIGNhcmRzXHJcbiAgY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICAgIHtcclxuICAgICAgaXRlbXM6IFtdLFxyXG4gICAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XHJcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGNhcmREYXRhKTtcclxuICAgICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgICBwbGFjZXNMaXN0XHJcbiAgKTtcclxuXHJcbiAgY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gICAgbmFtZVNlbGVjdG9yOiBzZWxlY3RvcnMudXNlck5hbWUsXHJcbiAgICBqb2JTZWxlY3Rvcjogc2VsZWN0b3JzLnVzZXJKb2IsXHJcbiAgICBhdmF0YXJTZWxlY3Rvcjogc2VsZWN0b3JzLnVzZXJBdmF0YXIsXHJcbiAgfSk7XHJcblxyXG4gIGZ1bmN0aW9uIGFkZENhcmQoY2FyZERhdGEpIHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XHJcbiAgICBjYXJkU2VjdGlvbi5wcmVwZW5kSXRlbShjYXJkRWxlbWVudCk7XHJcbiAgfVxyXG5cclxuICAvLyBMb2FkIGluaXRpYWwgdXNlciBpbmZvIGFuZCBjYXJkcyBmcm9tIHRoZSBzZXJ2ZXJcclxuICBQcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXHJcbiAgICAudGhlbigoW3VzZXJEYXRhLCBjYXJkc10pID0+IHtcclxuICAgICAgLy9jb25zb2xlLmxvZyhjYXJkcyk7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxyXG4gICAgICAgIGpvYjogdXNlckRhdGEuYWJvdXQsXHJcbiAgICAgICAgYXZhdGFyOiB1c2VyRGF0YS5hdmF0YXIsXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY2FyZHMuZm9yRWFjaCgoY2FyZERhdGEpID0+IHtcclxuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xyXG4gICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG4gICAgICB9KTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKCkgPT4ge30pO1xyXG5cclxuICAvLyBGb3JtIGhhbmRsaW5nIGZ1bmN0aW9uc1xyXG4gIGNvbnN0IGhhbmRsZVByb2ZpbGVFZGl0ID0gKGlucHV0VmFsdWVzLCBwb3B1cCkgPT4ge1xyXG4gICAgcG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICAgIGFwaVxyXG4gICAgICAudXBkYXRlVXNlckluZm8oe1xyXG4gICAgICAgIG5hbWU6IGlucHV0VmFsdWVzLm5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IGlucHV0VmFsdWVzLmluZm8sXHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKCh1cGRhdGVkVXNlcikgPT4ge1xyXG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgICAgICAgIG5hbWU6IHVwZGF0ZWRVc2VyLm5hbWUsXHJcbiAgICAgICAgICBqb2I6IHVwZGF0ZWRVc2VyLmFib3V0LFxyXG4gICAgICAgICAgYXZhdGFyOiB1cGRhdGVkVXNlci5hdmF0YXIsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcG9wdXAuY2xvc2UoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKCgpID0+IHt9KVxyXG4gICAgICAuZmluYWxseSgoKSA9PiB7ICAgICAgICBcclxuICAgICAgICBwb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgaGFuZGxlQXZhdGFyRWRpdCA9IChpbnB1dFZhbHVlcywgcG9wdXApID0+IHtcclxuICAgIHBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgICBhcGlcclxuICAgICAgLnVwZGF0ZUF2YXRhcih7XHJcbiAgICAgICAgYXZhdGFyOiBpbnB1dFZhbHVlcy5saW5rLFxyXG4gICAgICB9KVxyXG4gICAgICAudGhlbigodXBkYXRlZFVzZXIpID0+IHtcclxuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgICAgICBuYW1lOiB1cGRhdGVkVXNlci5uYW1lLFxyXG4gICAgICAgICAgam9iOiB1cGRhdGVkVXNlci5hYm91dCxcclxuICAgICAgICAgIGF2YXRhcjogdXBkYXRlZFVzZXIuYXZhdGFyLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHBvcHVwLnJlc2V0Rm9ybSgpO1xyXG4gICAgICAgIHBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoKSA9PiB7fSlcclxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgIHBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpOyAgICAgICAgICAgICAgICBcclxuICAgICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgaGFuZGxlTmV3Q2FyZCA9IChpbnB1dFZhbHVlcywgcG9wdXApID0+IHtcclxuICAgIFxyXG4gICAgY29uc3QgY2FyZERhdGEgPSB7XHJcbiAgICAgIG5hbWU6IGlucHV0VmFsdWVzLnRpdGxlLFxyXG4gICAgICBsaW5rOiBpbnB1dFZhbHVlcy5saW5rLFxyXG4gICAgfTtcclxuICAgIHBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgICBhcGlcclxuICAgICAgLmNyZWF0ZUNhcmQoY2FyZERhdGEpXHJcbiAgICAgIC50aGVuKChuZXdDYXJkKSA9PiB7XHJcbiAgICAgICAgYWRkQ2FyZChuZXdDYXJkKTtcclxuICAgICAgICBwb3B1cC5yZXNldEZvcm0oKTtcclxuICAgICAgICBwb3B1cC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKCkgPT4ge30pXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICBwb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgLy8gQ3JlYXRlIGZvcm0gcG9wdXAgaW5zdGFuY2VzXHJcbiAgY29uc3QgcG9wdXBXaXRoRWRpdEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICAgIHNlbGVjdG9ycy5wb3B1cEVkaXRVc2VyLFxyXG4gICAgaGFuZGxlUHJvZmlsZUVkaXRcclxuICApO1xyXG4gIGNvbnN0IHBvcHVwV2l0aEFkZENhcmRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgICBzZWxlY3RvcnMucG9wdXBBZGRDYXJkLFxyXG4gICAgaGFuZGxlTmV3Q2FyZFxyXG4gICk7XHJcbiAgY29uc3QgcG9wdXBXaXRoQXZhdGFyRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gICAgc2VsZWN0b3JzLnBvcHVwRWRpdEF2YXRhcixcclxuICAgIGhhbmRsZUF2YXRhckVkaXRcclxuICApO1xyXG4gIGNvbnN0IHBvcHVwV2l0aENvbmZpcm1EZWxldGUgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICAgIHNlbGVjdG9ycy5wb3B1cENvbmZpcm1EZWxldGUsXHJcbiAgICAoX2lucHV0VmFsdWVzLCBwb3B1cCkgPT4ge1xyXG4gICAgICBpZiAoIWNhcmRUb0RlbGV0ZSkge1xyXG4gICAgICAgIHBvcHVwLmNsb3NlKCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGNhcmRUb0RlbGV0ZVxyXG4gICAgICAgIC5kZWxldGVDYXJkKGFwaSlcclxuICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICBwb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgICAgY2FyZFRvRGVsZXRlID0gbnVsbDtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoKSA9PiB7fSk7XHJcbiAgICB9XHJcbiAgKTtcclxuXHJcbiAgLy8gSGFuZGxlIHZhbGlkYXRpb25cclxuICBjb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25Db25maWcsIGVkaXRGb3JtKTtcclxuICBjb25zdCBhZGRDYXJkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25Db25maWcsIGFkZENhcmRGb3JtKTtcclxuICBjb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvbkNvbmZpZywgYXZhdGFyRm9ybSk7XHJcblxyXG4gIGVkaXRGb3JtLl9mb3JtVmFsaWRhdG9yID0gZWRpdEZvcm1WYWxpZGF0b3I7XHJcbiAgYWRkQ2FyZEZvcm0uX2Zvcm1WYWxpZGF0b3IgPSBhZGRDYXJkRm9ybVZhbGlkYXRvcjtcclxuICBhdmF0YXJGb3JtLl9mb3JtVmFsaWRhdG9yID0gYXZhdGFyRm9ybVZhbGlkYXRvcjtcclxuXHJcbiAgZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIGFkZENhcmRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICBhdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbiAgLy8gU2V0dXAgcG9wdXAgZXZlbnQgbGlzdGVuZXJzXHJcbiAgcG9wdXBXaXRoSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICBwb3B1cFdpdGhFZGl0Rm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIHBvcHVwV2l0aEFkZENhcmRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgcG9wdXBXaXRoQXZhdGFyRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIHBvcHVwV2l0aENvbmZpcm1EZWxldGUuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgLy8gU2V0dXAgYnV0dG9uIGxpc3RlbmVyc1xyXG4gIHVzZXJBZGRQbGFjZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgcG9wdXBXaXRoQWRkQ2FyZEZvcm0ub3BlbigpO1xyXG4gICAgYWRkQ2FyZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uSWZFbXB0eSgpO1xyXG4gIH0pO1xyXG5cclxuICB1c2VyRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgY29uc3QgY3VycmVudFVzZXJJbmZvID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICAgIHBvcHVwV2l0aEVkaXRGb3JtLnNldElucHV0VmFsdWVzKHtcclxuICAgICAgbmFtZTogY3VycmVudFVzZXJJbmZvLm5hbWUsXHJcbiAgICAgIGluZm86IGN1cnJlbnRVc2VySW5mby5qb2IsXHJcbiAgICB9KTtcclxuICAgIHBvcHVwV2l0aEVkaXRGb3JtLm9wZW4oKTtcclxuICAgIGVkaXRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG5cclxuICB1c2VyRWRpdEF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgcG9wdXBXaXRoQXZhdGFyRm9ybS5vcGVuKCk7XHJcbiAgICBhdmF0YXJGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbklmRW1wdHkoKTtcclxuICB9KTtcclxuXHJcblxyXG59KSgpO1xyXG4iXSwibmFtZXMiOlsidmFsaWRhdGlvbkNvbmZpZyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiY2FyZENvbmZpZyIsInBvcHVwQ29uZmlnIiwiYXBpQ29uZmlnIiwiYmFzZVVybCIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwiRm9ybVZhbGlkYXRvciIsImNvbnN0cnVjdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsInRoaXMiLCJfc2V0dGluZ3MiLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRzIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJxdWVyeVNlbGVjdG9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsImlucHV0IiwiZXJyb3JFbGVtZW50IiwiaWQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInJlbW92ZSIsIl9pc0Zvcm1WYWxpZCIsIkFycmF5IiwiZnJvbSIsImV2ZXJ5IiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZGlzYWJsZWQiLCJfdmFsaWRhdGVGb3JtU3RhdGUiLCJmb3JFYWNoIiwiX2FkZEV2ZW50TGlzdGVuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiZW5hYmxlVmFsaWRhdGlvbiIsIl9pc0Zvcm1FbXB0eSIsInZhbHVlIiwicmVzZXRWYWxpZGF0aW9uSWZFbXB0eSIsInJlc2V0VmFsaWRhdGlvbiIsIkNhcmQiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbGV0ZSIsImFwaSIsIm5hbWUiLCJsaW5rIiwiX2lkIiwiX3RlbXBsYXRlIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsZXRlIiwiX2FwaSIsImlzTGlrZWQiLCJCb29sZWFuIiwiX2VsZW1lbnQiLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2dlbmVyYXRlQ2FyZCIsIl9jYXJkSW1hZ2VFbGVtZW50IiwiX2NhcmROYW1lRWxlbWVudCIsIl9saWtlQnV0dG9uIiwiX2RlbGV0ZUJ1dHRvbiIsInN0eWxlIiwiYmFja2dyb3VuZEltYWdlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiZ2V0RWxlbWVudCIsIl9oYW5kbGVMaWtlIiwibGlrZVN0YXR1cyIsImNoYW5nZUxpa2VTdGF0dXMiLCJ0aGVuIiwidG9nZ2xlIiwiY2F0Y2giLCJkZWxldGVDYXJkIiwiX29uRGVsZXRlQ2xpY2siLCJlIiwic3RvcFByb3BhZ2F0aW9uIiwiU2VjdGlvbiIsIml0ZW1zIiwicmVuZGVyZXIiLCJjb250YWluZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJhcHBlbmRDaGlsZCIsInByZXBlbmRJdGVtIiwicHJlcGVuZCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsImRvY3VtZW50IiwiX2Nsb3NlQnV0dG9uIiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiUG9wdXBXaXRoSW1hZ2UiLCJzdXBlciIsIl9pbWFnZUVsZW1lbnQiLCJfaW1hZ2VEZXNjcmlwdGlvbiIsInNyYyIsImFsdCIsImltZ0RpdiIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0IiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZm9ybSIsIl9mb3JtRGF0YSIsIl9zdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsInNldElucHV0VmFsdWVzIiwiT2JqZWN0Iiwia2V5cyIsImxlbmd0aCIsIl9mb3JtVmFsaWRhdG9yIiwicmVzZXRGb3JtIiwicmVzZXQiLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwiVXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2pvYkVsZW1lbnQiLCJfYXZhdGFyRWxlbWVudCIsImdldFVzZXJJbmZvIiwiam9iIiwic2V0VXNlckluZm8iLCJhdmF0YXIiLCJBcGkiLCJvbkVycm9yIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsIl9vbkVycm9yIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiX2hhbmRsZVJlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsIl9yZXF1ZXN0IiwicGF0aCIsIm9wdGlvbnMiLCJmZXRjaCIsInVwZGF0ZVVzZXJJbmZvIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInVwZGF0ZUF2YXRhciIsImdldEluaXRpYWxDYXJkcyIsImNyZWF0ZUNhcmQiLCJjYXJkSWQiLCJzaG91bGRMaWtlIiwiY2FyZFRlbXBsYXRlIiwiZWRpdEZvcm0iLCJhZGRDYXJkRm9ybSIsImF2YXRhckZvcm0iLCJ1c2VyRWRpdEJ1dHRvbiIsInVzZXJBZGRQbGFjZUJ1dHRvbiIsInVzZXJFZGl0QXZhdGFyQnV0dG9uIiwicGxhY2VzTGlzdCIsInBvcHVwV2l0aEltYWdlIiwiY2FyZCIsImNhcmRUb0RlbGV0ZSIsImhhbmRsZURlbGV0ZVJlcXVlc3QiLCJwb3B1cFdpdGhDb25maXJtRGVsZXRlIiwiY2FyZERhdGEiLCJjYXJkU2VjdGlvbiIsImNhcmRFbGVtZW50IiwidXNlckluZm8iLCJhbGwiLCJ1c2VyRGF0YSIsImNhcmRzIiwicG9wdXBXaXRoRWRpdEZvcm0iLCJoYW5kbGVQcm9maWxlRWRpdCIsInBvcHVwIiwiaW5mbyIsInVwZGF0ZWRVc2VyIiwiZmluYWxseSIsInBvcHVwV2l0aEFkZENhcmRGb3JtIiwiaGFuZGxlTmV3Q2FyZCIsInRpdGxlIiwibmV3Q2FyZCIsImFkZENhcmQiLCJwb3B1cFdpdGhBdmF0YXJGb3JtIiwiaGFuZGxlQXZhdGFyRWRpdCIsIl9pbnB1dFZhbHVlcyIsImVkaXRGb3JtVmFsaWRhdG9yIiwiYWRkQ2FyZEZvcm1WYWxpZGF0b3IiLCJhdmF0YXJGb3JtVmFsaWRhdG9yIiwiY3VycmVudFVzZXJJbmZvIl0sInNvdXJjZVJvb3QiOiIifQ==