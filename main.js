!function(){"use strict";var e="";const t=[{name:"Yosemite Valley",link:e+"2e37fd0c260a298af732.jpg"},{name:"Lake Louise",link:e+"44e6fede87f55e5327cc.jpg"},{name:"Bald Mountains",link:e+"df100efc54d4645073d7.jpg"},{name:"Latemar",link:e+"e463b225f0897d749d63.jpg"},{name:"Vanoise National Park",link:e+"70aac30a40409c4dbc71.jpg"},{name:"Lago di Braies",link:e+"8edfe6cd78e39aafc871.jpg"}],s={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},i="popup_is-opened";class n{constructor(e,t){this._settings=e,this._formElement=t,this._inputs=this._formElement.querySelectorAll(this._settings.inputSelector),this._submitButton=this._formElement.querySelector(this._settings.submitButtonSelector)}_checkInputValidity(e){const t=this._formElement.querySelector(`#${e.id}-error`);t&&(e.validity.valid?this._hideInputError(e,t):this._showInputError(e,t))}_showInputError(e,t){e.classList.add(this._settings.inputErrorClass),t.classList.add(this._settings.errorClass),t.textContent=e.validationMessage}_hideInputError(e,t){e.classList.remove(this._settings.inputErrorClass),t.classList.remove(this._settings.errorClass),t.textContent=""}_isFormValid(){return Array.from(this._inputs).every(e=>e.validity.valid)}_toggleButtonState(){this._submitButton&&(this._isFormValid()?(this._submitButton.classList.remove(this._settings.inactiveButtonClass),this._submitButton.disabled=!1):(this._submitButton.classList.add(this._settings.inactiveButtonClass),this._submitButton.disabled=!0))}_validateFormState(){this._inputs.forEach(e=>{this._checkInputValidity(e)}),this._toggleButtonState()}_addEventListeners(){this._inputs.forEach(e=>{e.addEventListener("input",()=>this._validateFormState())}),this._formElement.addEventListener("submit",e=>(e.preventDefault(),this._isFormValid()))}enableValidation(){this._addEventListeners(),this._validateFormState()}_isFormEmpty(){return Array.from(this._inputs).every(e=>""===e.value)}resetValidationIfEmpty(){this._isFormEmpty()&&this.resetValidation()}resetValidation(){this._inputs.forEach(e=>{const t=this._formElement.querySelector(`#${e.id}-error`);t&&this._hideInputError(e,t)}),this._toggleButtonState()}}class r{constructor(e,t,s){this.name=e.name,this.link=e.link,this._template=t,this._handleImageClick=s,this.isLiked=!1,this._element=null}_getTemplate(){return this._template.content.querySelector(".place-card").cloneNode(!0)}_generateCard(){return this._element=this._getTemplate(),this._cardImageElement=this._element.querySelector(".place-card__image"),this._cardNameElement=this._element.querySelector(".place-card__name"),this._likeButton=this._element.querySelector(".place-card__like-icon"),this._deleteButton=this._element.querySelector(".place-card__delete-icon"),this._cardImageElement.style.backgroundImage=`url(${this.link})`,this._cardNameElement.textContent=this.name,this._setEventListeners(),this._element}getElement(){return this._element||this._generateCard(),this._element}_handleLike(){this.isLiked=!this.isLiked,this._likeButton.classList.toggle("place-card__like-icon_liked")}_handleDelete(){this._element.remove()}_setEventListeners(){this._cardImageElement.addEventListener("click",()=>{this._handleImageClick(this)}),this._likeButton.addEventListener("click",e=>{e.stopPropagation(),this._handleLike()}),this._deleteButton.addEventListener("click",e=>{e.stopPropagation(),this._handleDelete()})}}class o{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=s}renderItems(){this._items.forEach(e=>{this._renderer(e)})}addItem(e){this._container.appendChild(e)}prependItem(e){this._container.prepend(e)}}class a{constructor(e){this._popup=document.querySelector(e),this._closeButton=this._popup.querySelector(".popup__close")}open(){this._popup.classList.add(i),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove(i),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popup.addEventListener("click",e=>{e.target!==this._popup&&e.target!==this._closeButton||this.close()})}}class l extends a{constructor(e){super(e),this._imageElement=this._popup.querySelector(".popup__image img"),this._imageDescription=this._popup.querySelector(".popup__image-description")}open(e,t){if(this._imageElement)this._imageElement.src=t,this._imageElement.alt=e;else{const e=this._popup.querySelector(".popup__image");e&&(e.style.backgroundImage=`url(${t})`)}this._imageDescription.textContent=e,super.open()}}class _ extends a{constructor(e,t){super(e),this._handleFormSubmit=t,this._form=this._popup.querySelector(".popup__form"),this._inputs=this._form.querySelectorAll(".popup__input"),this._formData={}}_getInputValues(){const e={};return this._inputs.forEach(t=>{e[t.name]=t.value}),e}setInputValues(e){this._inputs.forEach(t=>{t.value=e[t.name]})}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues(),this)})}open(){Object.keys(this._formData).length>0&&this.setInputValues(this._formData),super.open()}close(){this._formData=this._getInputValues(),super.close(),this._form._formValidator&&this._form._formValidator.resetValidation()}resetForm(){this._form.reset(),this._formData={},this._form._formValidator&&this._form._formValidator.resetValidation()}}class u{constructor({nameSelector:e,jobSelector:t}){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo({name:e,job:t}){this._nameElement.textContent=e,this._jobElement.textContent=t}}const c=document.querySelector("#place-card-template"),p=document.querySelector(".popup_edit-user .popup__form"),m=document.querySelector(".popup_add-card .popup__form"),d=document.querySelector(".user-info__edit-icon"),h=document.querySelector(".user-info__place-button"),E=document.querySelector(".places-list");!function(){const e=new l(".popup_image"),i=t=>{e.open(t.name,t.link)};function a(e){return new r(e,c,i).getElement()}const f=new o({items:t,renderer:e=>{const t=a(e);f.addItem(t)}},E),g=new u({nameSelector:".user-info__name",jobSelector:".user-info__job"});f.renderItems();const v=new _(".popup_edit-user",(e,t)=>{g.setUserInfo({name:e.name,job:e.info}),t.close()}),y=new _(".popup_add-card",(e,t)=>{!function(e){const t=a(e);f.prependItem(t.getElement())}({name:e.title,link:e.link}),t.resetForm(),t.close()}),k=new n(s,p),S=new n(s,m);p._formValidator=k,m._formValidator=S,k.enableValidation(),S.enableValidation(),e.setEventListeners(),v.setEventListeners(),y.setEventListeners(),h.addEventListener("click",()=>{y.open(),S.resetValidationIfEmpty()}),d.addEventListener("click",()=>{const e=g.getUserInfo();v.setInputValues({name:e.name,info:e.job}),v.open(),k.resetValidation()})}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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InNvdXJjZXMiOlsid2VicGFjazovL0luc2VydCBwcm9qZWN0IG5hbWUvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vSW5zZXJ0IHByb2plY3QgbmFtZS93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9JbnNlcnQgcHJvamVjdCBuYW1lLy4vc3JjL3V0aWxzL2luaXRpYWxDYXJkcy5qcyIsIndlYnBhY2s6Ly9JbnNlcnQgcHJvamVjdCBuYW1lLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9JbnNlcnQgcHJvamVjdCBuYW1lLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9JbnNlcnQgcHJvamVjdCBuYW1lLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9JbnNlcnQgcHJvamVjdCBuYW1lLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9JbnNlcnQgcHJvamVjdCBuYW1lLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vSW5zZXJ0IHByb2plY3QgbmFtZS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL0luc2VydCBwcm9qZWN0IG5hbWUvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL0luc2VydCBwcm9qZWN0IG5hbWUvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9JbnNlcnQgcHJvamVjdCBuYW1lLy4vc3JjL3BhZ2VzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsImltcG9ydCB5b3NlbWl0ZUltZyBmcm9tIFwiLi4vaW1hZ2VzL2NhcmQtaW1hZ2VzL3lvc2VtaXRlLmpwZ1wiO1xuaW1wb3J0IGxha2VMb3Vpc2VJbWcgZnJvbSBcIi4uL2ltYWdlcy9jYXJkLWltYWdlcy9sYWtlLWxvdWlzZS5qcGdcIjtcbmltcG9ydCBiYWxkTW91bnRhaW5zSW1nIGZyb20gXCIuLi9pbWFnZXMvY2FyZC1pbWFnZXMvYmFsZC1tb3VudGFpbnMuanBnXCI7XG5pbXBvcnQgbGF0ZW1hckltZyBmcm9tIFwiLi4vaW1hZ2VzL2NhcmQtaW1hZ2VzL2xhdGVtYXIuanBnXCI7XG5pbXBvcnQgdmFub2lzZUltZyBmcm9tIFwiLi4vaW1hZ2VzL2NhcmQtaW1hZ2VzL3Zhbm9pc2UuanBnXCI7XG5pbXBvcnQgbGFnb0ltZyBmcm9tIFwiLi4vaW1hZ2VzL2NhcmQtaW1hZ2VzL2xhZ28uanBnXCI7XG5cbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgbGluazogeW9zZW1pdGVJbWcsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXG4gICAgbGluazogbGFrZUxvdWlzZUltZyxcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBiYWxkTW91bnRhaW5zSW1nLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXG4gICAgbGluazogbGF0ZW1hckltZyxcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogdmFub2lzZUltZyxcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICBsaW5rOiBsYWdvSW1nLFxuICB9LFxuXTtcblxuZXhwb3J0IHsgaW5pdGlhbENhcmRzIH07XG4iLCJleHBvcnQgY29uc3Qgc2VsZWN0b3JzID0ge1xuICAvLyBUZW1wbGF0ZXNcbiAgY2FyZFRlbXBsYXRlOiBcIiNwbGFjZS1jYXJkLXRlbXBsYXRlXCIsXG5cbiAgLy8gRm9ybXNcbiAgZWRpdEZvcm06IFwiLnBvcHVwX2VkaXQtdXNlciAucG9wdXBfX2Zvcm1cIixcbiAgYWRkQ2FyZEZvcm06IFwiLnBvcHVwX2FkZC1jYXJkIC5wb3B1cF9fZm9ybVwiLFxuXG4gIC8vIFBvcHVwc1xuICBwb3B1cEltYWdlOiBcIi5wb3B1cF9pbWFnZVwiLFxuICBwb3B1cEVkaXRVc2VyOiBcIi5wb3B1cF9lZGl0LXVzZXJcIixcbiAgcG9wdXBBZGRDYXJkOiBcIi5wb3B1cF9hZGQtY2FyZFwiLFxuXG4gIC8vIFVzZXIgSW5mb1xuICB1c2VyTmFtZTogXCIudXNlci1pbmZvX19uYW1lXCIsXG4gIHVzZXJKb2I6IFwiLnVzZXItaW5mb19fam9iXCIsXG4gIHVzZXJFZGl0QnV0dG9uOiBcIi51c2VyLWluZm9fX2VkaXQtaWNvblwiLFxuICB1c2VyQWRkUGxhY2VCdXR0b246IFwiLnVzZXItaW5mb19fcGxhY2UtYnV0dG9uXCIsXG5cbiAgLy8gTGlzdHNcbiAgcGxhY2VzTGlzdDogXCIucGxhY2VzLWxpc3RcIixcblxuICAvLyBJbnB1dCBmaWVsZHNcbiAgbmFtZUlucHV0OiBcIiNuYW1lXCIsXG4gIGluZm9JbnB1dDogXCIjaW5mb1wiLFxufTtcblxuLy8gVmFsaWRhdGlvbiBjb25maWd1cmF0aW9uXG5leHBvcnQgY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5wb3B1cF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcInBvcHVwX19lcnJvcl92aXNpYmxlXCIsXG59O1xuXG4vLyBDYXJkLXJlbGF0ZWQgY29uc3RhbnRzXG5leHBvcnQgY29uc3QgY2FyZENvbmZpZyA9IHtcbiAgY2FyZDogXCIucGxhY2UtY2FyZFwiLFxuICBjYXJkSW1hZ2U6IFwiLnBsYWNlLWNhcmRfX2ltYWdlXCIsXG4gIGNhcmROYW1lOiBcIi5wbGFjZS1jYXJkX19uYW1lXCIsXG4gIGxpa2VCdXR0b246IFwiLnBsYWNlLWNhcmRfX2xpa2UtaWNvblwiLFxuICBkZWxldGVCdXR0b246IFwiLnBsYWNlLWNhcmRfX2RlbGV0ZS1pY29uXCIsXG4gIGxpa2VkQ2xhc3M6IFwicGxhY2UtY2FyZF9fbGlrZS1pY29uX2xpa2VkXCIsXG59O1xuXG4vLyBQb3B1cC1yZWxhdGVkIGNvbnN0YW50c1xuZXhwb3J0IGNvbnN0IHBvcHVwQ29uZmlnID0ge1xuICBjbG9zZUJ1dHRvbjogXCIucG9wdXBfX2Nsb3NlXCIsXG4gIGZvcm06IFwiLnBvcHVwX19mb3JtXCIsXG4gIGlucHV0OiBcIi5wb3B1cF9faW5wdXRcIixcblxuICBpbWFnZTogXCIucG9wdXBfX2ltYWdlXCIsXG4gIGltYWdlSW1nOiBcIi5wb3B1cF9faW1hZ2UgaW1nXCIsXG4gIGltYWdlRGVzY3JpcHRpb246IFwiLnBvcHVwX19pbWFnZS1kZXNjcmlwdGlvblwiLFxuXG4gIG9wZW5lZENsYXNzOiBcInBvcHVwX2lzLW9wZW5lZFwiLFxufTtcbiIsIlwidXNlIHN0cmljdFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5fc2V0dGluZ3MgPSBzZXR0aW5ncztcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuX2lucHV0cyA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXG4gICAgICB0aGlzLl9zZXR0aW5ncy5pbnB1dFNlbGVjdG9yXG4gICAgKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICB9XG5cbiAgLy8gUHJpdmF0ZSBtZXRob2QgdG8gY2hlY2sgZmllbGQgdmFsaWRpdHlcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0LmlkfS1lcnJvcmApO1xuICAgIGlmICghZXJyb3JFbGVtZW50KSByZXR1cm47XG5cbiAgICBpZiAoaW5wdXQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0LCBlcnJvckVsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dCwgZXJyb3JFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICAvLyBQcml2YXRlIG1ldGhvZCB0byBzaG93IGVycm9yIGZvciBhbiBpbnB1dFxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXQsIGVycm9yRWxlbWVudCkge1xuICAgIGlucHV0LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgfVxuXG4gIC8vIFByaXZhdGUgbWV0aG9kIHRvIGhpZGUgZXJyb3IgZm9yIGFuIGlucHV0XG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dCwgZXJyb3JFbGVtZW50KSB7XG4gICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH1cblxuICAvLyBQcml2YXRlIG1ldGhvZCB0byBjaGVjayBpZiBlbnRpcmUgZm9ybSBpcyB2YWxpZFxuICBfaXNGb3JtVmFsaWQoKSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5faW5wdXRzKS5ldmVyeSgoaW5wdXQpID0+IGlucHV0LnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIC8vIFByaXZhdGUgbWV0aG9kIHRvIHRvZ2dsZSBidXR0b24gc3RhdGUgYmFzZWQgb24gZm9ybSB2YWxpZGl0eVxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKCF0aGlzLl9zdWJtaXRCdXR0b24pIHJldHVybjtcblxuICAgIGlmICh0aGlzLl9pc0Zvcm1WYWxpZCgpKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgLy8gUHJpdmF0ZSBtZXRob2QgdG8gdmFsaWRhdGUgZm9ybSBzdGF0ZVxuICBfdmFsaWRhdGVGb3JtU3RhdGUoKSB7XG4gICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXQpO1xuICAgIH0pO1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gIH1cblxuICAvLyBQcml2YXRlIG1ldGhvZCB0byBhZGQgZXZlbnQgbGlzdGVuZXJzXG4gIF9hZGRFdmVudExpc3RlbmVycygpIHtcbiAgICAvLyBBZGQgaW5wdXQgZXZlbnQgbGlzdGVuZXJzXG4gICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4gdGhpcy5fdmFsaWRhdGVGb3JtU3RhdGUoKSk7XG4gICAgfSk7XG5cbiAgICAvLyBBZGQgZm9ybSBzdWJtaXQgbGlzdGVuZXJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgcmV0dXJuIHRoaXMuX2lzRm9ybVZhbGlkKCk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBQdWJsaWMgbWV0aG9kIHRvIGVuYWJsZSBmb3JtIHZhbGlkYXRpb25cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9hZGRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3ZhbGlkYXRlRm9ybVN0YXRlKCk7XG4gIH1cblxuICAvLyBQcml2YXRlIG1ldGhvZCB0byBjaGVjayBpZiBhbGwgZm9ybSBpbnB1dHMgYXJlIGVtcHR5XG4gIF9pc0Zvcm1FbXB0eSgpIHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLl9pbnB1dHMpLmV2ZXJ5KChpbnB1dCkgPT4gaW5wdXQudmFsdWUgPT09IFwiXCIpO1xuICB9XG5cbiAgLy8gUHVibGljIG1ldGhvZCB0byByZXNldCB2YWxpZGF0aW9uIG9ubHkgaWYgZm9ybSBpcyBlbXB0eVxuICByZXNldFZhbGlkYXRpb25JZkVtcHR5KCkge1xuICAgIGlmICh0aGlzLl9pc0Zvcm1FbXB0eSgpKSB7XG4gICAgICB0aGlzLnJlc2V0VmFsaWRhdGlvbigpO1xuICAgIH1cbiAgfVxuXG4gIC8vIFB1YmxpYyBtZXRob2QgdG8gZGlzYWJsZSBidXR0b24gc3RhdGUgb3IgcmVzZXQgZm9ybSB2YWxpZGF0aW9uXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICAvLyBDbGVhciBhbGwgZXJyb3JzXG4gICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICBgIyR7aW5wdXQuaWR9LWVycm9yYFxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvckVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQsIGVycm9yRWxlbWVudCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBSZXNldCBidXR0b24gc3RhdGVcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICB9XG59XG4iLCJcInVzZSBzdHJpY3RcIjtcbmltcG9ydCB7IGNhcmRDb25maWcgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihkYXRhLCBjYXJkU2VsZWN0b3IsIGhhbmRsZUltYWdlQ2xpY2spIHtcbiAgICB0aGlzLm5hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX3RlbXBsYXRlID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgIHRoaXMuaXNMaWtlZCA9IGZhbHNlO1xuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIHJldHVybiB0aGlzLl90ZW1wbGF0ZS5jb250ZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihjYXJkQ29uZmlnLmNhcmQpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICB9XG5cbiAgX2dlbmVyYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKGNhcmRDb25maWcuY2FyZEltYWdlKTtcbiAgICB0aGlzLl9jYXJkTmFtZUVsZW1lbnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoY2FyZENvbmZpZy5jYXJkTmFtZSk7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihjYXJkQ29uZmlnLmxpa2VCdXR0b24pO1xuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihjYXJkQ29uZmlnLmRlbGV0ZUJ1dHRvbik7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHt0aGlzLmxpbmt9KWA7XG4gICAgdGhpcy5fY2FyZE5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gdGhpcy5uYW1lO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH1cblxuICBnZXRFbGVtZW50KCkge1xuICAgIGlmICghdGhpcy5fZWxlbWVudCkge1xuICAgICAgdGhpcy5fZ2VuZXJhdGVDYXJkKCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG5cbiAgX2hhbmRsZUxpa2UoKSB7XG4gICAgdGhpcy5pc0xpa2VkID0gIXRoaXMuaXNMaWtlZDtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoY2FyZENvbmZpZy5saWtlZENsYXNzKTtcbiAgfVxuXG4gIF9oYW5kbGVEZWxldGUoKSB7XG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB0aGlzLl9oYW5kbGVMaWtlKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlKCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsIlwidXNlIHN0cmljdFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICB9XG5cbiAgcHJlcGVuZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59XG4iLCJcInVzZSBzdHJpY3RcIjtcbmltcG9ydCB7IHBvcHVwQ29uZmlnIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKHBvcHVwQ29uZmlnLmNsb3NlQnV0dG9uKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChwb3B1cENvbmZpZy5vcGVuZWRDbGFzcyk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShwb3B1cENvbmZpZy5vcGVuZWRDbGFzcyk7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGUpID0+IHtcbiAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICBpZiAoZS50YXJnZXQgPT09IHRoaXMuX3BvcHVwIHx8IGUudGFyZ2V0ID09PSB0aGlzLl9jbG9zZUJ1dHRvbikge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsIlwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcbmltcG9ydCB7IHBvcHVwQ29uZmlnIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IocG9wdXBDb25maWcuaW1hZ2VJbWcpO1xuICAgIHRoaXMuX2ltYWdlRGVzY3JpcHRpb24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFxuICAgICAgcG9wdXBDb25maWcuaW1hZ2VEZXNjcmlwdGlvblxuICAgICk7XG4gIH1cblxuICBvcGVuKG5hbWUsIGxpbmspIHtcbiAgICBpZiAodGhpcy5faW1hZ2VFbGVtZW50KSB7XG4gICAgICB0aGlzLl9pbWFnZUVsZW1lbnQuc3JjID0gbGluaztcbiAgICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hbHQgPSBuYW1lO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBJZiBubyBpbWcgZWxlbWVudCwgc2V0IGFzIGJhY2tncm91bmQgaW1hZ2VcbiAgICAgIGNvbnN0IGltZ0RpdiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IocG9wdXBDb25maWcuaW1hZ2UpO1xuICAgICAgaWYgKGltZ0Rpdikge1xuICAgICAgICBpbWdEaXYuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybCgke2xpbmt9KWA7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuX2ltYWdlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbmltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuaW1wb3J0IHsgcG9wdXBDb25maWcgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3Rvcihwb3B1cENvbmZpZy5mb3JtKTtcbiAgICB0aGlzLl9pbnB1dHMgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwocG9wdXBDb25maWcuaW5wdXQpO1xuICAgIHRoaXMuX2Zvcm1EYXRhID0ge307XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xuICB9XG5cbiAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xuICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgLy8gSW5zZXJ0IHRoZSB2YWx1ZSBieSB0aGUgbmFtZSBvZiB0aGUgaW5wdXRcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcbiAgICB9KTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCksIHRoaXMpO1xuICAgIH0pO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICAvLyBSZXN0b3JlIGZvcm0gZGF0YSBpZiBpdCBleGlzdHMgZnJvbSBwcmV2aW91cyBjbG9zZSB3aXRob3V0IHN1Ym1pdFxuICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLl9mb3JtRGF0YSkubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5zZXRJbnB1dFZhbHVlcyh0aGlzLl9mb3JtRGF0YSk7XG4gICAgfVxuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIC8vIFNhdmUgZm9ybSBkYXRhIGJlZm9yZSBjbG9zaW5nXG4gICAgdGhpcy5fZm9ybURhdGEgPSB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xuICAgIHN1cGVyLmNsb3NlKCk7XG5cbiAgICAvLyBSZXNldCB2YWxpZGF0aW9uIGVycm9yc1xuICAgIGlmICh0aGlzLl9mb3JtLl9mb3JtVmFsaWRhdG9yKSB7XG4gICAgICB0aGlzLl9mb3JtLl9mb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xuICAgIH1cbiAgfVxuXG4gIHJlc2V0Rm9ybSgpIHtcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gICAgdGhpcy5fZm9ybURhdGEgPSB7fTtcbiAgICBpZiAodGhpcy5fZm9ybS5fZm9ybVZhbGlkYXRvcikge1xuICAgICAgdGhpcy5fZm9ybS5fZm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbiAgICB9XG4gIH1cbn1cbiIsIlwidXNlIHN0cmljdFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fam9iRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgam9iOiB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50LFxuICAgIH07XG4gIH1cblxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGpvYiB9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQgPSBqb2I7XG4gIH1cbn1cbiIsIlwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQgeyBpbml0aWFsQ2FyZHMgfSBmcm9tIFwiLi4vdXRpbHMvaW5pdGlhbENhcmRzLmpzXCI7XG5pbXBvcnQgeyB2YWxpZGF0aW9uQ29uZmlnLCBzZWxlY3RvcnMgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcblxuLy8gRE9NIEVsZW1lbnRzXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy5jYXJkVGVtcGxhdGUpO1xuY29uc3QgZWRpdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy5lZGl0Rm9ybSk7XG5jb25zdCBhZGRDYXJkRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JzLmFkZENhcmRGb3JtKTtcbmNvbnN0IHVzZXJFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvcnMudXNlckVkaXRCdXR0b24pO1xuY29uc3QgdXNlckFkZFBsYWNlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvcnMudXNlckFkZFBsYWNlQnV0dG9uKTtcbmNvbnN0IHBsYWNlc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy5wbGFjZXNMaXN0KTtcblxuLy8gSW5pdGlhbGl6ZSBldmVyeXRoaW5nXG4oZnVuY3Rpb24gKCkge1xuICBjb25zdCBwb3B1cFdpdGhJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZShzZWxlY3RvcnMucG9wdXBJbWFnZSk7XG5cbiAgY29uc3QgaGFuZGxlSW1hZ2VDbGljayA9IChjYXJkKSA9PiB7XG4gICAgcG9wdXBXaXRoSW1hZ2Uub3BlbihjYXJkLm5hbWUsIGNhcmQubGluayk7XG4gIH07XG5cbiAgZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSkge1xuICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChjYXJkRGF0YSwgY2FyZFRlbXBsYXRlLCBoYW5kbGVJbWFnZUNsaWNrKTtcbiAgICByZXR1cm4gY2FyZC5nZXRFbGVtZW50KCk7XG4gIH1cblxuICAvLyBDcmVhdGUgU2VjdGlvbiB3aXRoIGNhcmRzXG4gIGNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gICAge1xuICAgICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcbiAgICAgIHJlbmRlcmVyOiAoY2FyZERhdGEpID0+IHtcbiAgICAgICAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xuICAgICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmQpO1xuICAgICAgfSxcbiAgICB9LFxuICAgIHBsYWNlc0xpc3RcbiAgKTtcblxuICBjb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gICAgbmFtZVNlbGVjdG9yOiBzZWxlY3RvcnMudXNlck5hbWUsXG4gICAgam9iU2VsZWN0b3I6IHNlbGVjdG9ycy51c2VySm9iLFxuICB9KTtcblxuICBmdW5jdGlvbiBhZGRDYXJkKGNhcmREYXRhKSB7XG4gICAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xuICAgIGNhcmRTZWN0aW9uLnByZXBlbmRJdGVtKGNhcmQuZ2V0RWxlbWVudCgpKTtcbiAgfVxuXG4gIC8vIFJlbmRlciBpbml0aWFsIGNhcmRzXG4gIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG5cbiAgLy8gRm9ybSBoYW5kbGluZyBmdW5jdGlvbnNcbiAgY29uc3QgaGFuZGxlUHJvZmlsZUVkaXQgPSAoaW5wdXRWYWx1ZXMsIHBvcHVwKSA9PiB7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgbmFtZTogaW5wdXRWYWx1ZXMubmFtZSxcbiAgICAgIGpvYjogaW5wdXRWYWx1ZXMuaW5mbyxcbiAgICB9KTtcbiAgICBwb3B1cC5jbG9zZSgpO1xuICB9O1xuXG4gIGNvbnN0IGhhbmRsZU5ld0NhcmQgPSAoaW5wdXRWYWx1ZXMsIHBvcHVwKSA9PiB7XG4gICAgY29uc3QgY2FyZERhdGEgPSB7XG4gICAgICBuYW1lOiBpbnB1dFZhbHVlcy50aXRsZSxcbiAgICAgIGxpbms6IGlucHV0VmFsdWVzLmxpbmssXG4gICAgfTtcbiAgICBhZGRDYXJkKGNhcmREYXRhKTtcbiAgICBwb3B1cC5yZXNldEZvcm0oKTtcbiAgICBwb3B1cC5jbG9zZSgpO1xuICB9O1xuXG4gIC8vIENyZWF0ZSBmb3JtIHBvcHVwIGluc3RhbmNlc1xuICBjb25zdCBwb3B1cFdpdGhFZGl0Rm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICAgIHNlbGVjdG9ycy5wb3B1cEVkaXRVc2VyLFxuICAgIGhhbmRsZVByb2ZpbGVFZGl0XG4gICk7XG4gIGNvbnN0IHBvcHVwV2l0aEFkZENhcmRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gICAgc2VsZWN0b3JzLnBvcHVwQWRkQ2FyZCxcbiAgICBoYW5kbGVOZXdDYXJkXG4gICk7XG5cbiAgLy8gSGFuZGxlIHZhbGlkYXRpb25cbiAgY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uQ29uZmlnLCBlZGl0Rm9ybSk7XG4gIGNvbnN0IGFkZENhcmRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvbkNvbmZpZywgYWRkQ2FyZEZvcm0pO1xuXG4gIGVkaXRGb3JtLl9mb3JtVmFsaWRhdG9yID0gZWRpdEZvcm1WYWxpZGF0b3I7XG4gIGFkZENhcmRGb3JtLl9mb3JtVmFsaWRhdG9yID0gYWRkQ2FyZEZvcm1WYWxpZGF0b3I7XG5cbiAgZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuICBhZGRDYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbiAgLy8gU2V0dXAgcG9wdXAgZXZlbnQgbGlzdGVuZXJzXG4gIHBvcHVwV2l0aEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIHBvcHVwV2l0aEVkaXRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIHBvcHVwV2l0aEFkZENhcmRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgLy8gU2V0dXAgYnV0dG9uIGxpc3RlbmVyc1xuICB1c2VyQWRkUGxhY2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBwb3B1cFdpdGhBZGRDYXJkRm9ybS5vcGVuKCk7XG4gICAgYWRkQ2FyZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uSWZFbXB0eSgpO1xuICB9KTtcblxuICB1c2VyRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIGNvbnN0IGN1cnJlbnRVc2VySW5mbyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gICAgcG9wdXBXaXRoRWRpdEZvcm0uc2V0SW5wdXRWYWx1ZXMoe1xuICAgICAgbmFtZTogY3VycmVudFVzZXJJbmZvLm5hbWUsXG4gICAgICBpbmZvOiBjdXJyZW50VXNlckluZm8uam9iLFxuICAgIH0pO1xuICAgIHBvcHVwV2l0aEVkaXRGb3JtLm9wZW4oKTtcbiAgICBlZGl0Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbiAgfSk7XG59KSgpO1xuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJpbml0aWFsQ2FyZHMiLCJuYW1lIiwibGluayIsInZhbGlkYXRpb25Db25maWciLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsInBvcHVwQ29uZmlnIiwiRm9ybVZhbGlkYXRvciIsImNvbnN0cnVjdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsInRoaXMiLCJfc2V0dGluZ3MiLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRzIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJxdWVyeVNlbGVjdG9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsImlucHV0IiwiZXJyb3JFbGVtZW50IiwiaWQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInJlbW92ZSIsIl9pc0Zvcm1WYWxpZCIsIkFycmF5IiwiZnJvbSIsImV2ZXJ5IiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZGlzYWJsZWQiLCJfdmFsaWRhdGVGb3JtU3RhdGUiLCJmb3JFYWNoIiwiX2FkZEV2ZW50TGlzdGVuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiZW5hYmxlVmFsaWRhdGlvbiIsIl9pc0Zvcm1FbXB0eSIsInZhbHVlIiwicmVzZXRWYWxpZGF0aW9uSWZFbXB0eSIsInJlc2V0VmFsaWRhdGlvbiIsIkNhcmQiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsIl90ZW1wbGF0ZSIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiaXNMaWtlZCIsIl9lbGVtZW50IiwiX2dldFRlbXBsYXRlIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9nZW5lcmF0ZUNhcmQiLCJfY2FyZEltYWdlRWxlbWVudCIsIl9jYXJkTmFtZUVsZW1lbnQiLCJfbGlrZUJ1dHRvbiIsIl9kZWxldGVCdXR0b24iLCJzdHlsZSIsImJhY2tncm91bmRJbWFnZSIsIl9zZXRFdmVudExpc3RlbmVycyIsImdldEVsZW1lbnQiLCJfaGFuZGxlTGlrZSIsInRvZ2dsZSIsIl9oYW5kbGVEZWxldGUiLCJlIiwic3RvcFByb3BhZ2F0aW9uIiwiU2VjdGlvbiIsIml0ZW1zIiwicmVuZGVyZXIiLCJjb250YWluZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJhcHBlbmRDaGlsZCIsInByZXBlbmRJdGVtIiwicHJlcGVuZCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsImRvY3VtZW50IiwiX2Nsb3NlQnV0dG9uIiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiUG9wdXBXaXRoSW1hZ2UiLCJzdXBlciIsIl9pbWFnZUVsZW1lbnQiLCJfaW1hZ2VEZXNjcmlwdGlvbiIsInNyYyIsImFsdCIsImltZ0RpdiIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0IiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZm9ybSIsIl9mb3JtRGF0YSIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwic2V0SW5wdXRWYWx1ZXMiLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIiwiX2Zvcm1WYWxpZGF0b3IiLCJyZXNldEZvcm0iLCJyZXNldCIsIlVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJfbmFtZUVsZW1lbnQiLCJfam9iRWxlbWVudCIsImdldFVzZXJJbmZvIiwiam9iIiwic2V0VXNlckluZm8iLCJjYXJkVGVtcGxhdGUiLCJlZGl0Rm9ybSIsImFkZENhcmRGb3JtIiwidXNlckVkaXRCdXR0b24iLCJ1c2VyQWRkUGxhY2VCdXR0b24iLCJwbGFjZXNMaXN0IiwicG9wdXBXaXRoSW1hZ2UiLCJjYXJkIiwiY3JlYXRlQ2FyZCIsImNhcmREYXRhIiwiY2FyZFNlY3Rpb24iLCJ1c2VySW5mbyIsInBvcHVwV2l0aEVkaXRGb3JtIiwiaGFuZGxlUHJvZmlsZUVkaXQiLCJwb3B1cCIsImluZm8iLCJwb3B1cFdpdGhBZGRDYXJkRm9ybSIsImhhbmRsZU5ld0NhcmQiLCJhZGRDYXJkIiwidGl0bGUiLCJlZGl0Rm9ybVZhbGlkYXRvciIsImFkZENhcmRGb3JtVmFsaWRhdG9yIiwiY3VycmVudFVzZXJJbmZvIl0sInNvdXJjZVJvb3QiOiIifQ==